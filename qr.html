<!DOCTYPE html>
<html>
  <head>
    <title>QR-Code fÃ¼r Coyote Socket</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  </head>
  <body>
    <h1>Bitte QR-Code scannen</h1>
    <canvas id="qrcode"></canvas>

    <script type="module">
      import { connectionId } from "./wsConnection.js";

      const prefix =
        "https://www.dungeon-lab.com/app-download.php#DGLAB-SOCKET#";

      // Warte auf gÃ¼ltige connectionId
      const interval = setInterval(() => {
        if (connectionId) {
          clearInterval(interval);
          const wsURL = `wss://coyote-ws-server.onrender.com/${connectionId}`;
          const qrData = prefix + wsURL;

          console.log("ðŸ”¢ Generierte QR-Daten:", qrData);

          QRCode.toCanvas(
            document.getElementById("qrcode"),
            qrData,
            function (error) {
              if (error) console.error(error);
              else console.log("âœ… QR-Code erfolgreich generiert");
            }
          );
        }
      }, 200);
    </script>
  </body>
</html>
